{"version":3,"sources":["webpack://root/./docs/makeup-screenreader-trap/index.compiled.js","webpack://root/./packages/makeup-screenreader-trap/dist/index.js","webpack://root/./packages/makeup-screenreader-trap/dist/util.js","webpack://root/webpack/bootstrap"],"names":["screenreaderTrap","mainEl","trappedEl","dirtyObjects","util","filterSvg","item","tagName","toLowerCase","showElementPrep","el","useHiddenProperty","prepareElement","hideElementPrep","attributeName","dirtyValue","isProperty","cleanValue","getAttribute","untrap","forEach","preparedObj","setAttribute","removeAttribute","dispatchEvent","CustomEvent","bubbles","defaultOptions","module","exports","trap","selectedOptions","options","Object","assign","document","querySelector","ancestors","getAncestors","siblings","getSiblings","siblingsOfAncestors","getSiblingsOfAncestors","filter","concat","map","filterAncestor","nodeType","filterSibling","flattenArrays","a","b","getPreviousSiblings","arguments","length","undefined","previousSibling","push","getNextSiblings","nextSibling","getAllAncestors","nextAncestor","parentNode","reduce","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","querySelectorAll","addEventListener","this","e","console","log","innerText"],"mappings":"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","file":"makeup-screenreader-trap/index.min.js","sourcesContent":["\"use strict\";\n\nvar screenreaderTrap = require('../../packages/makeup-screenreader-trap');\n\ndocument.querySelectorAll('.trap').forEach(function (item) {\n  item.addEventListener('click', function () {\n    if (this.getAttribute('aria-pressed') === 'true') {\n      screenreaderTrap.untrap(this);\n    } else {\n      screenreaderTrap.trap(this, {\n        useHiddenProperty: false\n      });\n    }\n  });\n  item.addEventListener('screenreaderTrap', function (e) {\n    console.log(this, e);\n    this.innerText = 'Untrap';\n    this.setAttribute('aria-pressed', 'true');\n  });\n  item.addEventListener('screenreaderUntrap', function (e) {\n    console.log(this, e);\n    this.innerText = 'Trap';\n    this.setAttribute('aria-pressed', 'false');\n  });\n});\ndocument.addEventListener('screenreaderTrap', function (e) {\n  console.log(this, e);\n});\ndocument.addEventListener('screenreaderUntrap', function (e) {\n  console.log(this, e);\n});","'use strict';\n\nvar util = require('./util.js'); // the main landmark\n\n\nvar mainEl; // the element that will be trapped\n\nvar trappedEl; // collection of elements that get 'dirtied' with aria-hidden attr or hidden prop\n\nvar dirtyObjects; // filter function for svg elements\n\nvar filterSvg = function filterSvg(item) {\n  return item.tagName.toLowerCase() !== 'svg';\n};\n\nfunction showElementPrep(el, useHiddenProperty) {\n  var preparedElement;\n\n  if (useHiddenProperty === false) {\n    preparedElement = prepareElement(el, 'aria-hidden', 'false');\n  } else {\n    preparedElement = prepareElement(el, 'hidden', false);\n  }\n\n  return preparedElement;\n}\n\nfunction hideElementPrep(el, useHiddenProperty) {\n  var preparedElement;\n\n  if (useHiddenProperty === false) {\n    preparedElement = prepareElement(el, 'aria-hidden', 'true');\n  } else {\n    preparedElement = prepareElement(el, 'hidden', true);\n  }\n\n  return preparedElement;\n}\n\nfunction prepareElement(el, attributeName, dirtyValue) {\n  var isProperty = typeof dirtyValue === 'boolean';\n  return {\n    el: el,\n    attributeName: attributeName,\n    cleanValue: isProperty ? el[attributeName] : el.getAttribute(attributeName),\n    dirtyValue: dirtyValue,\n    isProperty: isProperty\n  };\n}\n\nfunction dirtyElement(preparedObj) {\n  if (preparedObj.isProperty === true) {\n    preparedObj.el[preparedObj.attributeName] = preparedObj.dirtyValue;\n  } else {\n    preparedObj.el.setAttribute(preparedObj.attributeName, preparedObj.dirtyValue);\n  }\n}\n\nfunction cleanElement(preparedObj) {\n  if (preparedObj.cleanValue) {\n    if (preparedObj.isProperty === true) {\n      preparedObj.el[preparedObj.attributeName] = preparedObj.cleanValue;\n    } else {\n      preparedObj.el.setAttribute(preparedObj.attributeName, preparedObj.cleanValue);\n    }\n  } else {\n    preparedObj.el.removeAttribute(preparedObj.attributeName);\n  }\n}\n\nfunction untrap() {\n  if (trappedEl) {\n    // restore 'dirtied' elements to their original state\n    dirtyObjects.forEach(function (item) {\n      return cleanElement(item);\n    });\n    dirtyObjects = []; // 're-enable' the main landmark\n\n    if (mainEl) {\n      mainEl.setAttribute('role', 'main');\n    } // let observers know the screenreader is now untrapped\n\n\n    trappedEl.dispatchEvent(new CustomEvent('screenreaderUntrap', {\n      bubbles: true\n    }));\n    trappedEl = null;\n  }\n}\n\nvar defaultOptions = {\n  useHiddenProperty: false\n};\n\nfunction trap(el, selectedOptions) {\n  // ensure current trap is deactivated\n  untrap();\n  var options = Object.assign({}, defaultOptions, selectedOptions); // update the trapped el reference\n\n  trappedEl = el; // update the main landmark reference\n\n  mainEl = document.querySelector('main, [role=\"main\"]'); // we must remove the main landmark to avoid issues on voiceover iOS\n\n  if (mainEl) {\n    mainEl.setAttribute('role', 'presentation');\n  } // cache all ancestors, siblings & siblings of ancestors for trappedEl\n\n\n  var ancestors = util.getAncestors(trappedEl);\n  var siblings = util.getSiblings(trappedEl);\n  var siblingsOfAncestors = util.getSiblingsOfAncestors(trappedEl); // if using hidden property, filter out SVG elements as they do not support this property\n\n  if (options.useHiddenProperty === true) {\n    siblings = siblings.filter(filterSvg);\n    siblingsOfAncestors = siblingsOfAncestors.filter(filterSvg);\n  } // prepare elements\n\n\n  dirtyObjects = [showElementPrep(trappedEl, options.useHiddenProperty)].concat(ancestors.map(function (item) {\n    return showElementPrep(item, options.useHiddenProperty);\n  })).concat(siblings.map(function (item) {\n    return hideElementPrep(item, options.useHiddenProperty);\n  })).concat(siblingsOfAncestors.map(function (item) {\n    return hideElementPrep(item, options.useHiddenProperty);\n  })); // update DOM\n\n  dirtyObjects.forEach(function (item) {\n    return dirtyElement(item);\n  }); // let observers know the screenreader is now trapped\n\n  trappedEl.dispatchEvent(new CustomEvent('screenreaderTrap', {\n    bubbles: true\n  }));\n}\n\nmodule.exports = {\n  trap: trap,\n  untrap: untrap\n};","'use strict'; // filter function for ancestor elements\n\nvar filterAncestor = function filterAncestor(item) {\n  return item.nodeType === 1 && item.tagName.toLowerCase() !== 'body' && item.tagName.toLowerCase() !== 'html';\n}; // filter function for sibling elements\n\n\nvar filterSibling = function filterSibling(item) {\n  return item.nodeType === 1 && item.tagName.toLowerCase() !== 'script';\n}; // reducer to flatten arrays\n\n\nvar flattenArrays = function flattenArrays(a, b) {\n  return a.concat(b);\n}; // recursive function to get previous sibling nodes of given element\n\n\nfunction getPreviousSiblings(el) {\n  var siblings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var previousSibling = el.previousSibling;\n\n  if (!previousSibling) {\n    return siblings;\n  }\n\n  siblings.push(previousSibling);\n  return getPreviousSiblings(previousSibling, siblings);\n} // recursive function to get next sibling nodes of given element\n\n\nfunction getNextSiblings(el) {\n  var siblings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var nextSibling = el.nextSibling;\n\n  if (!nextSibling) {\n    return siblings;\n  }\n\n  siblings.push(nextSibling);\n  return getNextSiblings(nextSibling, siblings);\n} // returns all sibling element nodes of given element\n\n\nfunction getSiblings(el) {\n  var allSiblings = getPreviousSiblings(el).concat(getNextSiblings(el));\n  return allSiblings.filter(filterSibling);\n} // recursive function to get all ancestor nodes of given element\n\n\nfunction getAllAncestors(el) {\n  var ancestors = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var nextAncestor = el.parentNode;\n\n  if (!nextAncestor) {\n    return ancestors;\n  }\n\n  ancestors.push(nextAncestor);\n  return getAllAncestors(nextAncestor, ancestors);\n} // get ancestor nodes of given element\n\n\nfunction getAncestors(el) {\n  return getAllAncestors(el).filter(filterAncestor);\n} // get siblings of ancestors (i.e. aunts and uncles) of given el\n\n\nfunction getSiblingsOfAncestors(el) {\n  return getAncestors(el).map(function (item) {\n    return getSiblings(item);\n  }).reduce(flattenArrays, []);\n}\n\nmodule.exports = {\n  getSiblings: getSiblings,\n  getAncestors: getAncestors,\n  getSiblingsOfAncestors: getSiblingsOfAncestors\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n"],"sourceRoot":""}